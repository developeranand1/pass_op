<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PassOP Web App</title>
    <link rel="icon" type="image/x-icon" href="img/reset-password.png">
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        clifford: '#da373d',
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Mulish:ital,wght@0,200..1000;1,200..1000&display=swap');

        * {
            font-family: mulish, sans-serif;
        }
    </style>
     <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>

</head>

<body>

    <nav class="flex items-center justify-between flex-wrap bg-teal-500 p-4">
        <div class="flex items-center flex-shrink-0 text-white mr-6">
            <img class="fill-current h-8 w-8 mr-2" width="54" height="54" src="/img/lock.png" alt="">

            <span class="font-semibold text-xl tracking-tight">Pass OP</span>
        </div>
        <button
            class="inline-block text-sm px-4 py-2 leading-none border rounded text-white border-white hover:border-transparent hover:text-teal-500 hover:bg-white mt-4 lg:mt-0"
            onclick="downloadPDF()">Download</button>
        </div>
        </div>
    </nav>


    <div class="container mx-auto mt-10 p-4 bg-white  rounded-lg">
        <form onsubmit="return onSubmit(event)">
            <div class="flex flex-wrap mx-3 mb-2">
                <div class="w-full md:w-1/4 px-3 mb-6 md:mb-0">
                    <label class="block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2" for="grid-city">
                        Username
                    </label>

                    <input
                        class="appearance-none block w-full bg-gray-200 text-gray-700 border border-gray-200 rounded py-3 px-4 leading-tight focus:outline-none focus:bg-white focus:border-gray-500"
                        type="text" placeholder="Enter username" id="username" name="username">
                </div>
                <div class="w-full md:w-1/4 px-3 mb-6 md:mb-0">
                    <label class="block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2" for="grid-state">
                        Website URL
                    </label>
                    <input
                        class="appearance-none block w-full bg-gray-200 text-gray-700 border border-gray-200 rounded py-3 px-4 leading-tight focus:outline-none focus:bg-white focus:border-gray-500"
                        type="text" placeholder="Enter website URL" id="url" name="url">

                </div>
                <div class="w-full md:w-1/4 px-3 mb-6 md:mb-0">
                    <label class="block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2" for="grid-zip">
                        Password
                    </label>
                    <input
                        class="appearance-none block w-full bg-gray-200 text-gray-700 border border-gray-200 rounded py-3 px-4 leading-tight focus:outline-none focus:bg-white focus:border-gray-500"
                        type="text" placeholder="Enter password " id="password" name="password">

                </div>
                <div class="w-full md:w-1/4 px-3 mb-6 md:mb-0  md:mt-4">
                    <button
                        class="text-white w-full bg-gradient-to-br from-green-400 to-blue-600 hover:bg-gradient-to-bl focus:ring-4 focus:outline-none focus:ring-green-200 dark:focus:ring-green-800 font-medium rounded-lg text-sm px-5 py-3 text-center mb-2 mt-2"
                        type="submit" id="submitButton">Submit</button>
                    <button
                        class="text-white w-full bg-gradient-to-br from-green-400 to-blue-600 hover:bg-gradient-to-bl focus:ring-4 focus:outline-none focus:ring-green-200 dark:focus:ring-green-800 font-medium rounded-lg text-sm px-5 py-3 text-center mb-2 mt-2"
                        type="button" id="updateButton" style="display: none;" onclick="updateData()">Update</button>
                    <input type="hidden" id="editId" value="">
                    <!-- <button onclick="clearTable()" type="button">Clear Table</button> -->
                </div>

            </div>
        </form>


        <div class="overflow-x-auto mx-5">
            <table class="table-auto w-full">
                <thead>
                    <tr class="border bg-gray-200 rounded">
                        <th class="px-4 py-2 border">#</th>
                        <th class="px-4 py-2 border">UserName</th>
                        <th class="px-4 py-2 border">Website URL</th>
                        <th class="px-4 py-2 border">Password</th>
                        <th class="px-4 py-2 border">Action</th>
                    </tr>
                </thead>
                <tbody id="tableData">
                    <tr>
                        <td class="border px-4 py-2">Intro to CSS</td>
                        <td class="border px-4 py-2">Intro to CSS</td>
                        <td class="border px-4 py-2">Intro to CSS</td>
                        <td class="border px-4 py-2">Adam</td>
                        <td class="border px-4 py-2">858</td>
                    </tr>
                    <tr class="bg-gray-100">
                        <td class="border px-4 py-2">A Long and Winding Tour of the History of UI Frameworks and Tools
                            and
                            the Impact on Design</td>
                        <td class="border px-4 py-2">Adam</td>
                        <td class="border px-4 py-2">112</td>
                    </tr>
                    <tr>
                        <td class="border px-4 py-2">Intro to JavaScript</td>
                        <td class="border px-4 py-2">Chris</td>
                        <td class="border px-4 py-2">1,280</td>
                    </tr>
                </tbody>
            </table>

        </div>
    </div>




    <script>

        let values = {};
        let data = [];

        function onSubmit(event) {
            event.preventDefault();
            const username = document.getElementById("username").value
            const url = document.getElementById("url").value
            const password = document.getElementById('password').value;
            const i = data.length + 1;
            values = { username: username, url: url, password: password, id: i };
            data.push(values);
            let dataString = JSON.stringify(data);
            localStorage.setItem("details", dataString);
            resetForm();
            getData()
            Swal.fire(
                'Submitted!',
                'Your data has been submitted.',
                'success'
            )
        }

        function downloadPDF() {
            const doc = new jsPDF();
            const tableData = [];
            const rows = document.querySelectorAll("table tbody tr");
            rows.forEach(row => {
                const rowData = [];
                row.querySelectorAll("td").forEach(cell => {
                    rowData.push(cell.textContent);
                });
                tableData.push(rowData);
            });

            doc.autoTable({
                head: [['#', "Username", "Website URL", "Password"]],
                body: tableData
            });
            doc.save('password_Data.pdf');
        }


        function resetForm() {
            document.getElementById("username").value = ""
            document.getElementById("url").value = ""
            document.getElementById('password').value = ""
            document.getElementById("editId").value = "";
        }

        function clearTable() {
            localStorage.removeItem('details');
            data = [];
            getData()
        }

        function removeData(id) {
            Swal.fire({
                title: 'Are you sure?',
                text: "You won't be able to revert this!",
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                confirmButtonText: 'Yes, delete it!'
            }).then((result) => {
                if (result.isConfirmed) {
                    data = data.filter(item => item.id !== id);
                    localStorage.setItem('details', JSON.stringify(data));
                    getData();
                    Swal.fire(
                        'Deleted!',
                        'Your data has been deleted.',
                        'success'
                    )
                }
            })
        }



        function editData(id) {
            const itemEdit = data.find(item => item.id === id);
            if (itemEdit) {
                document.getElementById("editId").value = id;
                document.getElementById("username").value = itemEdit.username;
                document.getElementById("url").value = itemEdit.url;
                document.getElementById('password').value = itemEdit.password;

                document.getElementById("submitButton").style.display = "none";
                document.getElementById("updateButton").style.display = "inline-block";
            }
        }


        function updateData() {
            const editId = parseInt(document.getElementById('editId').value);
            const newUsername = document.getElementById("username").value;
            const newName = document.getElementById("url").value;
            const newAge = document.getElementById('password').value;
            const index = data.findIndex(item => item.id === editId);
            if (index !== -1) {
                data[index].username = newUsername
                data[index].url = newName;
                data[index].password = newAge;
                localStorage.setItem("details", JSON.stringify(data));
                resetForm();
                document.getElementById("editId").value = "";
                getData();

                document.getElementById("submitButton").style.display = "inline-block";
                document.getElementById("updateButton").style.display = "none";
            }
            Swal.fire(
                'Updated!',
                'Your data has been updated.',
                'success'
            )

        }

        function getData() {
            const getItem = JSON.parse(localStorage.getItem('details'));
            console.log(getItem);
            const userTable = document.getElementById('tableData');
            userTable.innerHTML = "";
            if (getItem) {
                data = getItem;
                getItem.forEach((item, index) => {
                    const row = `
                        <tr class='border text-center'>
                            <td class="border px-4 py-2">${index + 1}</td>
                              <td class="border px-4 py-2">${item.username}</td>
                            <td class="border px-4 py-2">${item.url}</td>
                            <td class="border px-4 py-2">${item.password}</td>
                            <td class="border px-4 py-2"><button onclick="removeData(${item.id})"><span class="material-symbols-outlined">delete</span></button> <button onclick=editData(${item.id})><span class="material-symbols-outlined">edit</span></button></td> 
                        </tr>
                    `;
                    userTable.innerHTML += row;
                })
            }

        }




        window.onload = getData();

    </script>
</body>

</html>